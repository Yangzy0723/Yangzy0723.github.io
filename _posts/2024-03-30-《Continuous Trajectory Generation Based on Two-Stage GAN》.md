---
layout: mypost
title: 《Continuous Trajectory Generation Based on Two-Stage GAN》
categories: [论文阅读]
---
# 《Continuous Trajectory Generation Based on Two-Stage GAN》

**[原文](trojectory+generator.pdf)**

## Abstract

本文提出了一个新颖的两阶段生成对抗框架来生成道路网络上的连续轨迹，即`TS-TrajGen`，它有效地将人类移动领域知识与无模型学习范式相结合。

具体来说，我们根据`A*`算法的人类移动假设构建生成器来学习人类移动行为。对于鉴别器，顺序奖励（sequential reward）和移动偏航奖励（mobility yaw reward）结合在一起，以增强生成器的有效性。
- 我想顺序奖励通常是指根据生成的轨迹数据的顺序或连续性来奖励或惩罚生成器；移动偏航奖励可能涉及到对轨迹中的移动方向或角度进行奖励或惩罚，以确保生成的轨迹在模拟人类移动时具有合理的行为

最后，我们提出了一个新颖的两阶段生成过程，以克服现有随机生成过程的弱点。

## Introduction

生成合成且逼真的轨迹的重要性：
1. 合成轨迹对于城市规划、疫情传播分析和交通控制至关重要
2. 生成合成轨迹是保护人类移动轨迹数据隐私的可行解决方案

当前模拟人类移动轨迹存在的问题:
- 基于模型的方法使用具有明确物理意义的有限参数来建模。然而，事实上人类移动行为表现出复杂的顺序转换规律，可能是时间依赖性的和高阶的

-> 提出无模型方法,使用神经网络生成范式，如生成对抗网络和变分自动编码器

存在问题：
- 生成的轨迹的连续性问题被忽视了。当前方法生成的轨迹不是在道路网络上连续的路径，这使得这些合成轨迹在交通仿真等下游应用中无法使用
- 不利用人类移动先验知识的无模型方法不能有效生成连续轨迹
- 现有方法的随机生成过程存在误差累积问题，轨迹是根据生成器给定的概率随机生成的。然而，一旦生成器预测错误，该过程将在错误的前提下继续生成，这降低了生成轨迹的质量

然后文章大致介绍了基于[A*假设](https://zh.wikipedia.org/wiki/A*%E6%90%9C%E5%B0%8B%E6%BC%94%E7%AE%97%E6%B3%95)，这里提出的方法是如何解决上述三个问题的。

首次通过将A*算法与神经网络相结合来解决城市道路网络上的连续轨迹生成问题。

## Preliminary

**轨迹定义：** 一个时间顺序序列$T=\{x_1,x_2,...,x_n\}$，其中$x_i$是一个元组$(l_i,t_i)$，$l_i$指示位置（道路段ID），$x_i$指示时间戳

**连续轨迹定义：** 指的是序列中的相邻元素$x_i,x_{i+1}$指示的道路段$l_i, l_{i+1}$在路网中是相邻的

**Continuous Mobility Trajectory Generation：** 给定一个真实世界的移动轨迹数据集，通过一个$\Theta$参数化的生成模型$G$生成一个连续的移动轨迹
$\hat{T} = \{\hat{x_1}, \hat{x_2},..., \hat{x_n}\}$

事实上，这是一个马尔可夫决策过程（MDP），记**现有状态$s$由$x_{1:i}$**组成，给定**目标道路段$l_d$**，**下一步道路段选择为$l_{i+1}$**（**行动记为$a$**），那么运动策略实际上建模为$\pi(a|s)$

**Human Movement Policy：** 
$\pi(a|s)=P(a|s)=P(l_{i+1}|x_{1:i}\cap l_d）$

**生成过程可以描述为将以下生成轨迹的概率最大化：**
$\hat{T}=\max\prod\limits_{i=1}^n\pi(a_i|s_i)=\max\limits_{P_\Theta}\prod\limits_{i=1}^nP_\Theta(l_{i+1}|x_{1:i}\cap l_d)$

## The Proposed Framework

**生成器$G$：** 学习人类移动策略$\pi(a|s)$

**判别器$D$：** 生成**奖励$R$** 以引导生成器的优化过程

![生成器和判别器](G_and_P.png)

根据前文定义*Human Movement Policy*，为考虑当前部分轨迹和旅行目的地的影响，采用`A*`来建模人类移动策略$\pi(a|s)$

$f(l_j)=g(l_j)+h(l_j)$，$g(l_j)$评估当前部分轨迹的观察成本，$h(l_j)$估计通过候选道路$l_j$到达目的地$l_d$的预期成本
$f(l_j)=-\log\pi(a|s)=-\log P(l_j|x_{1:i}\cap l_d)$

单纯使用`A*`存在不足：
- 原始的$g$和$h$是基于道路段之间的球面距离计算的，这使得学习多样化的人类移动策略变得困难
- 球面距离无法准确估计预期成本

因此，在本文中使用神经网络来实现$g$和$h$

### Function $g$
